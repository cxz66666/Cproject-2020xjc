军粮 大分类

解放区  国统区 

土地改革  3块

国统区土改方案 --难题  --老/新解放区土改--真的愿意上战场嘛？





军粮







### 开发者文档





主要思路  

操作后对mydata.h中数据进行更改    如果重新需要calculate出绘图的参数 则调用calculate函数，将数据写入mydata或者head等结构体中   之后display根据mydata中数据进行绘制



display**主要**：如果不在保存文件情况中  使用updatedisplay加速完成绘图

displayclear清屏

Drawmenu画出上方选项栏

Drawmain进行主要绘图

DrawOpenDir 画出选择csv的界面  如果其中进行是否存在该csv文件的判断，如果有的话直接将Isopen=2

如果在保存界面就画出savetocsv  可以输入中文



如果isopen=2就调用主要的drawpicture 主要传入参数NowSHowtable，两种情况如果传的head，绘制文件中数据展示的图，如果传入PreHead，画预测图

Drawstatus 画出目前正在的操作装在 在左下角



DrawLeftButton 日期每十个翻一页   列每四个翻一页，重点逻辑在翻页的控制，控制nownum和NowDateNum（当前为第几页  从0开始计算）的比较  选择时候画出该图像以及何时停止

而ADD DELTE函数更像是一个**有序栈**   **如果选中该列就有序的将该num按大小顺序插入到CHoosedColumn中  否则每次遍历都要跑IsCHooseColumn    之后遍历只用跑ChoosedCOlumn 减少时间复杂度**

 

如果正在改变数据  则绘制确认按钮  同时有个check函数   将返回值写在ERROR ANs中   

复原按钮不多解释



DrawMainPictue 分为6部分  画日期  画xy线  画主要的数据曲线  画箭头   画数字显示   画图例



日期中循环调用DrawEachDate   写中文 和写数字的函数不多解释   如果正在更改数据情况下，每个下面画一个小按钮 ，按中则表示更改当日的日期，最多智能选中一个，如果选两个会直接取消第一个的选中



xy线美什么好说的



主要的数据曲线中 遍历每一个选中的Column 

IsChooseColumn 1为直线 2为柱状图  

如果他是直线且被选中   那么将往准备画图的数据全部加上鼠标偏移量  相当于移动

如果是1就使用插值法  封装好的不用动   My——Draw——k表示两个点间插多少值

如果是2就用画柱状图的简单算法  分要画1个柱状图  和要画两个柱状图讨论

直线坐标加完偏移量后  因为如果不进行有关操作不会重新calculate计算TableData的数据 那么需要减去偏移量



画lasttableNUm中 **tail放的是**  最后一个被选中的日期  需要在这个日期后加该日期的数据  那么就简单的遍历tail中所有的column，对每个选中的column写数据

如果某直线/柱状图被选中，那么好了对该直线/柱状图上所有被选中的日期都显示数据  具体算法不细说



画图例美什么好说的





drawpridict为主入口  分别绘制各种输入框  

安了预测按钮后会进行检测 具体检测流程不细说 如果检测成功

 则free 原先创立的存放预测数据的链表节点 

从文件中和找到目标开始的节点，将该节点传给PreparePredict

PreparePredict中创建目的数量的节点 

从目标节点开始拷贝数据，预测阶数如果不写 ，自动比较0-5阶拟合度

如果0  用指数拟合   如果1-5用polyfit拟合



Calculate里进行当前展示图表展示位置计算

CubicEquation放的是三次线性插值法的四个参数  用于handlemouse检测是否选中该曲线

接着计算出SHow 的Date数量  以及最大的num数 便于画出六条基准线

接这找Tablemark1  算法近似四舍五入思想  特判num《1000情况



之后计算出目标点的 xy位置写入xyposition中  单位英寸



AssignTable分配是否是画曲线还是柱状图   默认4个一下一个柱状图  4个以上两个柱状图   都是将前1/2个分配为柱状图



handlemouse 选xy轴好说  选曲线就用三次线性插值法的四个系数和nowx算出可能的y，在和nowy进行比对，小于阈值即可认为选中该曲线



 

